<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>유튜브 대본 추출기 - 바이브코딩랩</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4f46e5',
                        secondary: '#10b981'
                    },
                    borderRadius: {
                        'none': '0px', 'sm': '4px', DEFAULT: '8px', 'md': '12px', 'lg': '16px', 'xl': '20px', '2xl': '24px', '3xl': '32px', 'full': '9999px', 'button': '8px'
                    }
                }
            }
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .loader { border-top-color: #4f46e5; }
    </style>
</head>
<body class="bg-gray-50">

    <!-- 헤더 섹션 -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html" class="flex items-center">
                <img src="https://static.readdy.ai/image/44bc93fdb7ef51b226b65177596745ae/2a757f0e7ad5f5b6553c8f682c39ea79.png" alt="바이브코딩랩 로고" class="h-10 w-auto">
            </a>
            <nav class="hidden md:flex space-x-8">
                <a href="index.html" class="text-gray-800 hover:text-primary font-medium">홈</a>
                <a href="index.html#programs" class="text-gray-800 hover:text-primary font-medium">프로그램</a>
            </nav>
            <a href="https://www.youtube.com/channel/UCUgHa5wpVuCmb6w1FMAQ1eg" target="_blank" class="flex items-center bg-red-600 text-white px-4 py-2 !rounded-button hover:bg-red-700 transition duration-300 whitespace-nowrap">
                <div class="w-5 h-5 flex items-center justify-center mr-2"><i class="ri-youtube-fill"></i></div>
                유튜브 채널
            </a>
        </div>
    </header>

    <!-- 대본 추출기 섹션 -->
    <main class="py-16 md:py-24">
        <div class="container mx-auto px-4">
            <div class="max-w-3xl mx-auto">
                <div class="text-center mb-12">
                    <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">유튜브 대본 추출기</h1>
                    <p class="text-xl text-gray-600">영상 링크만으로 대본(자막)을 손쉽게 추출하고 복사하세요.</p>
                </div>

                <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                    <div class="mb-4">
                        <label for="youtube-url" class="block text-sm font-medium text-gray-700 mb-2">유튜브 영상 URL</label>
                        <input type="url" id="youtube-url" class="w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="https://www.youtube.com/watch?v=...">
                    </div>

                    <button id="extract-btn" class="w-full bg-primary text-white py-3 px-6 !rounded-button text-lg font-semibold hover:bg-indigo-600 transition duration-300 flex items-center justify-center">
                        <i class="ri-file-text-line mr-2"></i>
                        <span>대본 추출하기</span>
                    </button>

                    <div id="result-container" class="mt-6">
                        <!-- 결과 표시 영역 -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 푸터 -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <p class="text-gray-400">ⓒ 2025 바이브코딩랩. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const urlInput = document.getElementById('youtube-url');
        const extractBtn = document.getElementById('extract-btn');
        const resultContainer = document.getElementById('result-container');

        // 유튜브 비디오 ID 추출 함수
        function getVideoId(url) {
            try {
                const urlObj = new URL(url);
                if (urlObj.hostname === 'youtu.be') {
                    return urlObj.pathname.slice(1);
                } else if (urlObj.hostname.includes('youtube.com')) {
                    return urlObj.searchParams.get('v');
                }
                return null;
            } catch (e) {
                return null;
            }
        }

        // 결과 표시 함수
        function displayResult(content, type) {
            let bgColor, borderColor, textColor, icon;
            if (type === 'success') {
                bgColor = 'bg-gray-50';
                borderColor = 'border-gray-200';
                textColor = 'text-gray-700';
            } else if (type === 'error') {
                bgColor = 'bg-red-50';
                borderColor = 'border-red-400';
                textColor = 'text-red-700';
                icon = '<i class="ri-error-warning-line mr-2"></i>';
            } else { // loading
                bgColor = 'bg-blue-50';
                borderColor = 'border-blue-400';
                textColor = 'text-blue-700';
                icon = '<div class="loader animate-spin rounded-full w-5 h-5 border-2 border-t-2 border-gray-200 mr-3"></div>';
            }

            let html = `<div class="p-4 rounded-lg border ${bgColor} ${borderColor}">`;
            if (type === 'success') {
                html += `
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="text-lg font-semibold text-gray-800">추출된 대본</h3>
                        <button id="copy-btn" class="bg-gray-200 text-gray-700 px-3 py-1 rounded-md text-sm hover:bg-gray-300">
                            <i class="ri-clipboard-line mr-1"></i>복사하기
                        </button>
                    </div>
                    <textarea readonly class="w-full h-64 p-3 border rounded-md bg-white text-gray-800">${content}</textarea>
                `;
            } else {
                html += `<p class="font-semibold ${textColor} flex items-center">${icon || ''} ${content}</p>`;
            }
            html += `</div>`;
            resultContainer.innerHTML = html;

            if (type === 'success') {
                document.getElementById('copy-btn').addEventListener('click', function() {
                    navigator.clipboard.writeText(content).then(() => {
                        this.innerHTML = '<i class="ri-check-line mr-1"></i>복사 완료!';
                        setTimeout(() => {
                            this.innerHTML = '<i class="ri-clipboard-line mr-1"></i>복사하기';
                        }, 2000);
                    });
                });
            }
        }

        extractBtn.addEventListener('click', async function() {
            const url = urlInput.value.trim();
            if (!url) {
                displayResult('유튜브 영상 URL을 입력해주세요.', 'error');
                return;
            }

            const videoId = getVideoId(url);
            if (!videoId) {
                displayResult('올바른 유튜브 영상 URL 형식이 아닙니다.', 'error');
                return;
            }

            displayResult('대본을 추출하고 있습니다. 잠시만 기다려주세요...', 'loading');

            try {
                // Vercel에 배포된 서버리스 함수 주소로 변경해야 합니다.
                const response = await fetch(`https://daniel17290221-github-io.vercel.app/api/extractor?video_id=${videoId}`);
                const data = await response.json();

                if (response.ok) {
                    displayResult(data.transcript, 'success');
                } else {
                    throw new Error(data.error || '알 수 없는 오류가 발생했습니다.');
                }
            } catch (error) {
                console.error(error);
                displayResult('대본을 가져올 수 없습니다. 영상에 한국어 또는 영어 자막이 있는지 확인해주세요.', 'error');
            }
        });
    });
    </script>

</body>
</html>
